From 74063f8c071454159b0f443637ab4837460e858c Mon Sep 17 00:00:00 2001
From: looooo <sppedflyer@gmail.com>
Date: Sun, 3 Jul 2016 23:55:23 +0200
Subject: [PATCH 1/3] cmake fix: not use togl if USE_Gui = FALSE

---
 ng/CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ng/CMakeLists.txt b/ng/CMakeLists.txt
index 354851a..1070f61 100644
--- a/ng/CMakeLists.txt
+++ b/ng/CMakeLists.txt
@@ -18,6 +18,7 @@ if(USE_GUI)
         set_target_properties(netgen PROPERTIES OUTPUT_NAME netgen)
     endif(APPLE)
 
+    add_subdirectory(Togl2.1)
 endif(USE_GUI)
 
 if(USE_PYTHON)
@@ -39,6 +40,5 @@ install(FILES
     occgeom.tcl acisgeom.tcl netgen.ocf
     DESTINATION ${ng_install_dir_bin} COMPONENT netgen)
 
-add_subdirectory(Togl2.1)
 install(FILES drawing.tcl DESTINATION ${ng_install_dir_bin} COMPONENT netgen)
 
-- 
2.7.4


From ac887710ce4a5ffe87cd79c2c10ad879d31314a9 Mon Sep 17 00:00:00 2001
From: looooo <sppedflyer@gmail.com>
Date: Mon, 4 Jul 2016 00:04:45 +0200
Subject: [PATCH 2/3] not link visual stuff when building netgen without gui

---
 nglib/CMakeLists.txt | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/nglib/CMakeLists.txt b/nglib/CMakeLists.txt
index f172f7e..08be658 100644
--- a/nglib/CMakeLists.txt
+++ b/nglib/CMakeLists.txt
@@ -22,7 +22,9 @@ endif(WIN32)
 
 add_library(nglib SHARED nglib.cpp ${nglib_objects})
 if(NOT WIN32)
-      target_link_libraries( nglib mesh stlvis stl geom2dvis interface geom2d csg stl visual csgvis )
+    target_link_libraries( nglib mesh stl interface geom2d csg stl visual)
+    if(USE_GUI)
+        target_link_libraries(nglib stlvis geom2dvis csgvis)
 endif(NOT WIN32)
 
 target_link_libraries( nglib ${OCC_LIBRARIES} ${MPI_CXX_LIBRARIES} ${OPENGL_LIBRARIES} ${TK_LIBRARY} ${TCL_LIBRARY} ${CMAKE_THREAD_LIBS_INIT} ${X11_Xmu_LIB} ${JPEG_LIBRARIES} ${MKL_LIBRARIES} ${ZLIB_LIBRARIES} ${OCC_LIBRARIES} )
-- 
2.7.4


From 63f5d0ed835535e34c5bc4f8f61050f83cec4fba Mon Sep 17 00:00:00 2001
From: looooo <sppedflyer@gmail.com>
Date: Mon, 4 Jul 2016 00:06:23 +0200
Subject: [PATCH 3/3] close the if

---
 nglib/CMakeLists.txt | 1 +
 1 file changed, 1 insertion(+)

diff --git a/nglib/CMakeLists.txt b/nglib/CMakeLists.txt
index 08be658..803f610 100644
--- a/nglib/CMakeLists.txt
+++ b/nglib/CMakeLists.txt
@@ -25,6 +25,7 @@ if(NOT WIN32)
     target_link_libraries( nglib mesh stl interface geom2d csg stl visual)
     if(USE_GUI)
         target_link_libraries(nglib stlvis geom2dvis csgvis)
+    endif(USE_GUI)
 endif(NOT WIN32)
 
 target_link_libraries( nglib ${OCC_LIBRARIES} ${MPI_CXX_LIBRARIES} ${OPENGL_LIBRARIES} ${TK_LIBRARY} ${TCL_LIBRARY} ${CMAKE_THREAD_LIBS_INIT} ${X11_Xmu_LIB} ${JPEG_LIBRARIES} ${MKL_LIBRARIES} ${ZLIB_LIBRARIES} ${OCC_LIBRARIES} )
-- 
2.7.4

